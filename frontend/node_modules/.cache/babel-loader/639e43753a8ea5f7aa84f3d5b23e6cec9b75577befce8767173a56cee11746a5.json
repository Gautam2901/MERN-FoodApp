{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Asus\\\\OneDrive\\\\Desktop\\\\PRABHAT_Coding\\\\MERN\\\\Projects_2024\\\\ReactJs\\\\foodApp\\\\src\\\\context\\\\StoreContext.js\",\n  _s = $RefreshSig$();\n// import { createContext, useEffect, useState } from \"react\";\n// import { food_list } from \"../assets/assets\";\n\n// export const StoreContext = createContext(null);\n\n// const StoreContextProvider = (props) => {\n\n//     const [cartItems, setCartItems] = useState({});\n\n//     const addToCart = (itemId) => {\n//         if(!cartItems[itemId]){\n//             setCartItems((prev)=>({...prev,[itemId]:1}))\n//         }\n//         else{\n//             setCartItems((prev)=>({...prev,[itemId]:prev[itemId]+1}))\n//         }\n//     }\n\n//     const removeFromCart = (itemId) => {\n//         setCartItems((prev)=>({...prev,[itemId]:prev[itemId]-1}))\n//     }\n\n//    const getTotalCartAmount = () => {\n//     let totalAmount = 0;\n//     for(const item in cartItems)\n//     {\n//         if(cartItems[item]>0){\n//             let itemInfo = food_list.find((product)=>product._id === item);\n//             totalAmount += itemInfo.price * cartItems[item];\n//         }\n//     }\n//     return totalAmount;\n//    }\n\n//     const contextValue = {\n//         food_list,\n//         cartItems,\n//         setCartItems,\n//         addToCart,\n//         removeFromCart,\n//         getTotalCartAmount\n//     }\n\n//     return(\n//         <StoreContext.Provider value={contextValue}>\n//             {props.children}\n//         </StoreContext.Provider>\n//     )\n// }\n\n// export default StoreContextProvider;\n\nimport axios from \"axios\";\nimport { createContext, useEffect, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const StoreContext = /*#__PURE__*/createContext(null);\nconst StoreContextProvider = props => {\n  _s();\n  const [cartItems, setCartItems] = useState({});\n  const url = \"http://localhost:4000\";\n  const [token, setToken] = useState(\"\");\n  const [food_list, setFood_list] = useState([]);\n\n  // Add item to cart\n  // Add item to cart\n  const addToCart = async itemId => {\n    // Update the cartItems state\n    setCartItems(prev => {\n      // Check if the item is already in the cart\n      const newQuantity = prev[itemId] ? prev[itemId] + 1 : 1;\n      return {\n        ...prev,\n        [itemId]: newQuantity\n      };\n    });\n\n    // If there is a token, make a POST request to update the cart on the server\n    if (token) {\n      try {\n        await axios.post(`${url}/api/cart/add`,\n        // Ensure you use template literals for URLs\n        {\n          itemId\n        }, {\n          headers: {\n            token\n          }\n        });\n      } catch (error) {\n        console.error('Error adding item to cart:', error);\n        // Optionally handle errors (e.g., show a message to the user)\n      }\n    }\n  };\n\n  // Remove item from cart\n  const removeFromCart = async itemId => {\n    setCartItems(prev => ({\n      ...prev,\n      [itemId]: prev[itemId] - 1\n    }));\n    if (token) {\n      await axios.post(url + \"/api/cart/remove\", {\n        itemId\n      }, {\n        headers: {\n          token\n        }\n      });\n    }\n  };\n\n  // Calculate total cart amount\n  const getTotalCartAmount = () => {\n    let totalAmount = 0;\n    for (const itemId in cartItems) {\n      if (cartItems[itemId] > 0) {\n        const itemInfo = food_list.find(product => product._id === itemId);\n        if (itemInfo) {\n          totalAmount += itemInfo.price * cartItems[itemId];\n        }\n      }\n    }\n    return totalAmount;\n  };\n  const fetchFoodList = async () => {\n    const response = await axios.get(url + \"/api/food/list\");\n    setFood_list(response.data.data);\n  };\n  const loadCartData = async token => {\n    const response = await axios.get(url + \"/api/cart/get\", {}, {\n      headers: {\n        token\n      }\n    });\n    setCartItems(response.data.cartData);\n  };\n  useEffect(() => {\n    async function loadData() {\n      await fetchFoodList();\n      if (localStorage.getItem(\"token\")) {\n        setToken(localStorage.getItem(\"token\"));\n        await loadCartData(localStorage.getItem(\"token\"));\n      }\n    }\n    loadData();\n  }, []);\n  const contextValue = {\n    food_list,\n    cartItems,\n    addToCart,\n    removeFromCart,\n    getTotalCartAmount,\n    url,\n    token,\n    setToken\n  };\n  return /*#__PURE__*/_jsxDEV(StoreContext.Provider, {\n    value: contextValue,\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 153,\n    columnNumber: 5\n  }, this);\n};\n_s(StoreContextProvider, \"zgBwUO+UiJHZ/pvIz4CrS+j1qGY=\");\n_c = StoreContextProvider;\nexport default StoreContextProvider;\nvar _c;\n$RefreshReg$(_c, \"StoreContextProvider\");","map":{"version":3,"names":["axios","createContext","useEffect","useState","jsxDEV","_jsxDEV","StoreContext","StoreContextProvider","props","_s","cartItems","setCartItems","url","token","setToken","food_list","setFood_list","addToCart","itemId","prev","newQuantity","post","headers","error","console","removeFromCart","getTotalCartAmount","totalAmount","itemInfo","find","product","_id","price","fetchFoodList","response","get","data","loadCartData","cartData","loadData","localStorage","getItem","contextValue","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Asus/OneDrive/Desktop/PRABHAT_Coding/MERN/Projects_2024/ReactJs/foodApp/src/context/StoreContext.js"],"sourcesContent":["// import { createContext, useEffect, useState } from \"react\";\r\n// import { food_list } from \"../assets/assets\";\r\n\r\n// export const StoreContext = createContext(null);\r\n\r\n// const StoreContextProvider = (props) => {\r\n\r\n\r\n//     const [cartItems, setCartItems] = useState({});\r\n    \r\n//     const addToCart = (itemId) => {\r\n//         if(!cartItems[itemId]){\r\n//             setCartItems((prev)=>({...prev,[itemId]:1}))\r\n//         }\r\n//         else{\r\n//             setCartItems((prev)=>({...prev,[itemId]:prev[itemId]+1}))\r\n//         }\r\n//     }\r\n\r\n//     const removeFromCart = (itemId) => {\r\n//         setCartItems((prev)=>({...prev,[itemId]:prev[itemId]-1}))\r\n//     }\r\n\r\n\r\n//    const getTotalCartAmount = () => {\r\n//     let totalAmount = 0;\r\n//     for(const item in cartItems)\r\n//     {\r\n//         if(cartItems[item]>0){\r\n//             let itemInfo = food_list.find((product)=>product._id === item);\r\n//             totalAmount += itemInfo.price * cartItems[item];\r\n//         }\r\n//     }\r\n//     return totalAmount;\r\n//    }\r\n\r\n//     const contextValue = {\r\n//         food_list,\r\n//         cartItems,\r\n//         setCartItems,\r\n//         addToCart,\r\n//         removeFromCart,\r\n//         getTotalCartAmount\r\n//     }\r\n    \r\n//     return(\r\n//         <StoreContext.Provider value={contextValue}>\r\n//             {props.children}\r\n//         </StoreContext.Provider>\r\n//     )\r\n// }\r\n\r\n// export default StoreContextProvider;\r\n\r\n\r\nimport axios from \"axios\";\r\nimport { createContext, useEffect, useState } from \"react\";\r\n\r\nexport const StoreContext = createContext(null);\r\n\r\nconst StoreContextProvider = (props) => {\r\n  const [cartItems, setCartItems] = useState({});\r\n  const url = \"http://localhost:4000\";\r\n  const [token, setToken] = useState(\"\");\r\n  const [food_list, setFood_list] = useState([]);\r\n\r\n\r\n  // Add item to cart\r\n  // Add item to cart\r\nconst addToCart = async (itemId) => {\r\n  // Update the cartItems state\r\n  setCartItems((prev) => {\r\n    // Check if the item is already in the cart\r\n    const newQuantity = prev[itemId] ? prev[itemId] + 1 : 1;\r\n    return { ...prev, [itemId]: newQuantity };\r\n  });\r\n\r\n  // If there is a token, make a POST request to update the cart on the server\r\n  if (token) {\r\n    try {\r\n      await axios.post(\r\n        `${url}/api/cart/add`, // Ensure you use template literals for URLs\r\n        { itemId },\r\n        { headers: { token } }\r\n      );\r\n    } catch (error) {\r\n      console.error('Error adding item to cart:', error);\r\n      // Optionally handle errors (e.g., show a message to the user)\r\n    }\r\n  }\r\n};\r\n\r\n\r\n  // Remove item from cart\r\n  const removeFromCart = async (itemId) => {\r\n    setCartItems((prev) => ({...prev, [itemId] :prev[itemId] - 1 }));\r\n      if(token){\r\n        await axios.post(url+\"/api/cart/remove\", {itemId}, {headers:{token}});\r\n      }\r\n  };\r\n\r\n  // Calculate total cart amount\r\n  const getTotalCartAmount = () => {\r\n    let totalAmount = 0;\r\n    for (const itemId in cartItems) {\r\n      if (cartItems[itemId] > 0) {\r\n        const itemInfo = food_list.find((product) => product._id === itemId);\r\n        if (itemInfo) {\r\n          totalAmount += itemInfo.price * cartItems[itemId];\r\n        }\r\n      }\r\n    }\r\n    return totalAmount;\r\n  };\r\n\r\n\r\n\r\n  const fetchFoodList = async()=>{\r\n    const response = await axios.get(url+\"/api/food/list\");\r\n    setFood_list(response.data.data);\r\n  }\r\n\r\n\r\n  const loadCartData = async (token) =>{\r\n    const response = await axios.get(url+\"/api/cart/get\", {},{headers:{token}});\r\n    setCartItems(response.data.cartData);\r\n  }\r\n\r\n\r\n  useEffect(()=>{\r\n    async function loadData() {\r\n      await fetchFoodList();\r\n      if(localStorage.getItem(\"token\")){\r\n        setToken(localStorage.getItem(\"token\"));\r\n        await loadCartData(localStorage.getItem(\"token\"));\r\n      }\r\n    }\r\n    loadData();\r\n  },[])\r\n\r\n  const contextValue = {\r\n    food_list,\r\n    cartItems,\r\n    addToCart,\r\n    removeFromCart,\r\n    getTotalCartAmount,\r\n    url,\r\n    token,\r\n    setToken\r\n  };\r\n\r\n  return (\r\n    <StoreContext.Provider value={contextValue}>\r\n      {props.children}\r\n    </StoreContext.Provider>\r\n  );\r\n};\r\n\r\nexport default StoreContextProvider;\r\n\r\n\r\n\r\n"],"mappings":";;AAAA;AACA;;AAEA;;AAEA;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAGA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,aAAa,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE3D,OAAO,MAAMC,YAAY,gBAAGL,aAAa,CAAC,IAAI,CAAC;AAE/C,MAAMM,oBAAoB,GAAIC,KAAK,IAAK;EAAAC,EAAA;EACtC,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGR,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC9C,MAAMS,GAAG,GAAG,uBAAuB;EACnC,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGX,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACY,SAAS,EAAEC,YAAY,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;;EAG9C;EACA;EACF,MAAMc,SAAS,GAAG,MAAOC,MAAM,IAAK;IAClC;IACAP,YAAY,CAAEQ,IAAI,IAAK;MACrB;MACA,MAAMC,WAAW,GAAGD,IAAI,CAACD,MAAM,CAAC,GAAGC,IAAI,CAACD,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC;MACvD,OAAO;QAAE,GAAGC,IAAI;QAAE,CAACD,MAAM,GAAGE;MAAY,CAAC;IAC3C,CAAC,CAAC;;IAEF;IACA,IAAIP,KAAK,EAAE;MACT,IAAI;QACF,MAAMb,KAAK,CAACqB,IAAI,CACd,GAAGT,GAAG,eAAe;QAAE;QACvB;UAAEM;QAAO,CAAC,EACV;UAAEI,OAAO,EAAE;YAAET;UAAM;QAAE,CACvB,CAAC;MACH,CAAC,CAAC,OAAOU,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;QAClD;MACF;IACF;EACF,CAAC;;EAGC;EACA,MAAME,cAAc,GAAG,MAAOP,MAAM,IAAK;IACvCP,YAAY,CAAEQ,IAAI,KAAM;MAAC,GAAGA,IAAI;MAAE,CAACD,MAAM,GAAGC,IAAI,CAACD,MAAM,CAAC,GAAG;IAAE,CAAC,CAAC,CAAC;IAC9D,IAAGL,KAAK,EAAC;MACP,MAAMb,KAAK,CAACqB,IAAI,CAACT,GAAG,GAAC,kBAAkB,EAAE;QAACM;MAAM,CAAC,EAAE;QAACI,OAAO,EAAC;UAACT;QAAK;MAAC,CAAC,CAAC;IACvE;EACJ,CAAC;;EAED;EACA,MAAMa,kBAAkB,GAAGA,CAAA,KAAM;IAC/B,IAAIC,WAAW,GAAG,CAAC;IACnB,KAAK,MAAMT,MAAM,IAAIR,SAAS,EAAE;MAC9B,IAAIA,SAAS,CAACQ,MAAM,CAAC,GAAG,CAAC,EAAE;QACzB,MAAMU,QAAQ,GAAGb,SAAS,CAACc,IAAI,CAAEC,OAAO,IAAKA,OAAO,CAACC,GAAG,KAAKb,MAAM,CAAC;QACpE,IAAIU,QAAQ,EAAE;UACZD,WAAW,IAAIC,QAAQ,CAACI,KAAK,GAAGtB,SAAS,CAACQ,MAAM,CAAC;QACnD;MACF;IACF;IACA,OAAOS,WAAW;EACpB,CAAC;EAID,MAAMM,aAAa,GAAG,MAAAA,CAAA,KAAS;IAC7B,MAAMC,QAAQ,GAAG,MAAMlC,KAAK,CAACmC,GAAG,CAACvB,GAAG,GAAC,gBAAgB,CAAC;IACtDI,YAAY,CAACkB,QAAQ,CAACE,IAAI,CAACA,IAAI,CAAC;EAClC,CAAC;EAGD,MAAMC,YAAY,GAAG,MAAOxB,KAAK,IAAI;IACnC,MAAMqB,QAAQ,GAAG,MAAMlC,KAAK,CAACmC,GAAG,CAACvB,GAAG,GAAC,eAAe,EAAE,CAAC,CAAC,EAAC;MAACU,OAAO,EAAC;QAACT;MAAK;IAAC,CAAC,CAAC;IAC3EF,YAAY,CAACuB,QAAQ,CAACE,IAAI,CAACE,QAAQ,CAAC;EACtC,CAAC;EAGDpC,SAAS,CAAC,MAAI;IACZ,eAAeqC,QAAQA,CAAA,EAAG;MACxB,MAAMN,aAAa,CAAC,CAAC;MACrB,IAAGO,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EAAC;QAC/B3B,QAAQ,CAAC0B,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC;QACvC,MAAMJ,YAAY,CAACG,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC;MACnD;IACF;IACAF,QAAQ,CAAC,CAAC;EACZ,CAAC,EAAC,EAAE,CAAC;EAEL,MAAMG,YAAY,GAAG;IACnB3B,SAAS;IACTL,SAAS;IACTO,SAAS;IACTQ,cAAc;IACdC,kBAAkB;IAClBd,GAAG;IACHC,KAAK;IACLC;EACF,CAAC;EAED,oBACET,OAAA,CAACC,YAAY,CAACqC,QAAQ;IAACC,KAAK,EAAEF,YAAa;IAAAG,QAAA,EACxCrC,KAAK,CAACqC;EAAQ;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACM,CAAC;AAE5B,CAAC;AAACxC,EAAA,CAhGIF,oBAAoB;AAAA2C,EAAA,GAApB3C,oBAAoB;AAkG1B,eAAeA,oBAAoB;AAAC,IAAA2C,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}